angular.module("ui-deni-grid",[]),angular.module("ui-deni-grid").constant("uiDeniGridConstants",{FIXED_COL_INDICATOR_WIDTH:"25px",FIXED_COL_ROWNUMBER_WIDTH:"38px",FIXED_COL_CHECKBOX_WIDTH:"30px",DEFAULT_COLUMN_HEADER_HEIGHT:"25px",DEFAULT_COLUMN_ROW_FOOTER_HEIGHT:"18px",DEFAULT_COLUMN_GROUPING_ROW_FOOTER_HEIGHT:"18px",DEFAULT_ROW_HEIGHT:"22px"}),angular.module("ui-deni-grid").directive("uiDeniGrid",function(e,o){return{restrict:"E",scope:{options:"="},replace:!1,bindToController:!0,controllerAs:"ctrl",controller:"uiDeniGridCtrl",template:e.get("ui-deni-grid")}}),angular.module("ui-deni-grid").service("uiDeniGridUtilSrv",function(e,o){var r=this;r.getFormatedValue=function(o,r){var r=r.toLowerCase();switch(r){case"currency":return e(r)(o);case"date":return e(r)(o,"MM/dd/yyyy");case"float":return e("currency")(o,"");case"int":case"integer":return o;case"lowercase":return o.toUpperCase();case"uppercase":return o.toLowerCase();default:return o}},r.setInputEditorDivCell=function(e,o,r,n){var t=function(){var e=r.editor;if(e===!0)e={type:"text"};else if(angular.isString(e))e={type:e};else if(!angular.isObject(e))throw new Error('"setInputEditorDivCell : " Property "editor" was set in a wrong way!');e.type==e.type.toLowerCase();var o;if("select"==e.type){o=$(document.createElement("select"));for(var n=0;n<e.items.length;n++){var t=document.createElement("option"),i=e.items[n];t.value=i.value,t.text=i.text,o.get(0).add(t)}}else o=$(document.createElement("input"));for(var a=Object.keys(r.editor),n=0;n<a.length;n++){var l=a[n];"items"!=l&&o.attr(l,r.editor[l])}return o},i=n.find(".ui-cell-inner"),a=i.html(),l=t();l.css("font-size",i.css("font-size")),l.css("font-family",i.css("font-familly")),l.addClass("ui-cell-input-editor"),l.attr("oldValue",a),l.val(a),i.remove();var s=n.css("padding");n.css("padding","0px"),n.append(l);var d=function(o,r){var t=o,i=t.parent(),a=$(document.createElement("span"));if(a.addClass("ui-cell-inner"),r){var l=t.val();t.remove(),i.append(a),e.options.api.updateSelectedCell(l)}else{var d=t.attr("oldValue");a.html(d),t.remove(),i.append(a)}n.css("padding",s)};l.keydown(function(e){27!=e.keyCode&&13!=e.keyCode||(27==e.keyCode?d($(e.target),!1):13==e.keyCode&&d($(e.target),!0))}),l.focusout(function(e){d($(e.target),!1)}),l.focus()},r.getRealColumnWidth=function(e,o,r){var n=r||e.clientWidth,t=o;return-1!=t.indexOf("%")&&(t=t.replace("%",""),t=n*t/100,t+="px"),t},r.getClientWidthDeniGrid=function(e){var o=e.bodyViewport.get(0).offsetWidth-e.bodyViewport.get(0).clientWidth,r=e.colsContainer.width()-o;return r},r.adjustColumnWidtsAccordingColumnHeader=function(e,o,r){var n=o.closest(".ui-header-container"),t=o.closest(".ui-container").find(".ui-body-container");t.find(".ui-row:not(.row-detail)").css("width",n.css("width"));var i=o.css("width");o.is(".ui-header-container-column.last-subcolumn")&&(i="calc("+i+" + 2px)"),t.find(".ui-cell[colIndex="+r+"]").css("width",i),e.options.data.length>0&&t.width(n.width())},r.setDefaultOptions=function(e){var n={};if(n.api={},n.listeners={},n.selType="row",n.autoLoad=!0,n.columnHeaderHeight=o.DEFAULT_COLUMN_HEADER_HEIGHT,n.columnFooterRowHeight=o.DEFAULT_COLUMN_ROW_FOOTER_HEIGHT,n.columnGroupingFooterRowHeight=o.DEFAULT_COLUMN_GROUPING_ROW_FOOTER_HEIGHT,n.enableGrouping=!0,n.enableColumnResize=!0,n.hideHeaders=!1,n.rowHeight=o.DEFAULT_ROW_HEIGHT,n.multiSelect=!1,n.sortableColumns=!0,n.sorters=[],n.stripRows=!0,angular.extend(n,e.options),e.options=n,e.options.hideHeaders=e.options.hideHeaders===!0||angular.isDefined(e.options.rowTemplate)||angular.isDefined(e.options.cardView),e.options.cardView&&(e.options.rowHeight=e.options.cardView.rowHeight||"150px"),e.options.rowHeight=e.options.rowHeight.toString(),e.isGrouped=e.options.enableGrouping&&angular.isDefined(e.options.grouping),e.isGrouped){if(angular.isString(e.options.grouping)&&(e.options.grouping={expr:e.options.grouping}),!angular.isObject(e.options.grouping)||angular.isArray(e.options.grouping))throw new Error('"loadData": param "grouping" passed in a wrong way');var t="<b>{"+e.options.grouping.expr+"}</b> ({count})";e.options.grouping.template=e.options.grouping.template||t}if(e.options.fixedCols){var i=function(n){var t=0;if(e.options.fixedCols.indicator&&(t+=parseFloat(o.FIXED_COL_INDICATOR_WIDTH.replace("px",""))),e.options.fixedCols.rowNumber&&(t+=parseFloat(o.FIXED_COL_ROWNUMBER_WIDTH.replace("px",""))),e.options.fixedCols.checkbox&&(t+=parseFloat(o.FIXED_COL_CHECKBOX_WIDTH.replace("px",""))),e.options.fixedCols.columns)for(var i=0;i<n.length;i++)t+=parseFloat(r.getRealColumnWidth(e,n[i].width).replace("px",""));return t};if(e.options.fixedCols===!0&&(e.options.fixedCols={indicator:!0}),angular.isDefined(e.options.fixedCols.indicator)&&e.options.fixedCols.indicator!==!0&&e.options.fixedCols.indicator!==!1)throw new Error('"setInitialDefaultOptions" : "fixedCols.indicator" property was set in a wrong way! (it must be a boolean value)');if(angular.isDefined(e.options.fixedCols.rowNumber)&&e.options.fixedCols.rowNumber!==!0&&e.options.fixedCols.rowNumber!==!1)throw new Error('"setInitialDefaultOptions" : "fixedCols.rowNumber" property was set in a wrong way! (it must be a boolean value)');if(angular.isDefined(e.options.fixedCols.checkbox)&&e.options.fixedCols.checkbox!==!0&&e.options.fixedCols.checkbox!==!1)throw new Error('"setInitialDefaultOptions" : "fixedCols.checkbox" property was set in a wrong way! (it must be a boolean value)');var a=e.options.fixedCols.columns;if(a){if(!angular.isArray(a))throw new Error('"setInitialDefaultOptions" : "fixedCols.columns" property was set in a wrong way!');for(var l=0;l<a.length;l++){for(var s=!1,d=0;d<e.options.columns.length;d++){var c=e.options.columns[d];if(c.name==a[l]){a[l]=c,s=!0;break}}if(!s)throw new Error('"setInitialDefaultOptions" : "fixedCols.columns" -> column "'+a[l]+'" not found!')}}e.options.fixedCols.width=i(a)}},r.remakeHeightBodyViewportWrapper=function(e){var o=3,r=o;"none"!=e.headerViewportWrapper.css("display")&&(r+=e.headerViewportWrapper.height()),"none"!=e.footerViewportWrapper.css("display")&&(r+=e.footerViewportWrapper.height());var n="calc(100% - "+r+"px)";e.bodyViewportWrapper.css("height",n)},r.hasColumnFooter=function(e){if(e.options.columns)for(var o=e.options.columns,r=0;r<o.length;r++)if(o[r].footer)return!0;return!1},r.getColumnHeaderLevels=function(e,o){for(var n=1,t=0;t<o.length;t++){var i=o[t];i.columns&&(n+=r.getColumnHeaderLevels(e,i.columns))}return n},r.getColumnFooterNumber=function(e){var o=0;if(e.options.columns)for(var r=0;r<e.options.columns.length;r++){var n=e.options.columns[r];if(n.footer){var t=angular.isArray(n.footer)?n.footer.length:1;t>o&&(o=t)}}return o},r.getColumnFooterRowsNumber=function(e,o){var r=0;if(e.options.columns)for(var n=0;n<e.options.columns.length;n++){var t=e.options.columns[n];if(t.footer){var i=1;if(angular.isArray(t.footer)){i=0;for(var a=0;a<t.footer.length;a++){var l=t.footer[a];angular.isObject(l)?o?0!=l.grouping&&i++:0!=l.grid&&i++:i++}}i>r&&(r=i)}}return r},r.createColumnFooters=function(e,o,n,t){if(!angular.isDefined(e.options.footerTemplate)){var i,a,l;t?(i="ui-footer-row",a="ui-footer-cell",l="ui-footer-cell-inner"):(i="ui-grouping-footer-row",a="ui-grouping-footer-cell",l="ui-grouping-footer-cell-inner");for(var s,d,c=t?e.columnFooterRowsNumberGrid:e.columnFooterRowsNumberGrouping,u=t?e.options.columnFooterRowHeight:e.options.columnGroupingFooterRowHeight,p=0;c>p;p++){var f=$(document.createElement("div"));if(f.css("height",u),f.addClass(i),f.attr("index",p),!angular.isDefined(e.options.footerRowTemplate))for(var w=0,m=0;m<n.length;m++){var g=n[m];s=$(document.createElement("div")),s.addClass(a),s.attr("index",m),s.css({width:r.getRealColumnWidth(e,g.width),"text-align":g.align}),f.append(s),g.footer&&(d=$(document.createElement("span")),d.addClass(l),w++,s.append(d),angular.isArray(g.footer)||(g.footer=[g.footer]))}o.append(f)}if(c>0){var v=o.find("."+i),h=$(v.get(0));h.find("."+a).addClass("first-row");var C=$(v.get(v.length-1));C.find("."+a).addClass("last-row");var x=h.find("."+a).length;o.find("."+a+"[footerColIndex=0]").addClass("first-col"),o.find("."+a+"[footerColIndex="+(x-1)+"]").addClass("last-col")}}},r.renderColumnFooters=function(e,o,n,t,i){var a,l,s;i?(a="ui-footer-row",l="ui-footer-cell",s="ui-footer-cell-inner"):(a="ui-grouping-footer-row",l="ui-grouping-footer-cell",s="ui-grouping-footer-cell-inner");for(var d={},c=0,u=0;u<e.columnFooterNumber;u++){var p,f={};angular.isDefined(e.options.footerTemplate)||(p=$(o.find("."+a)[u]));for(var w=0;w<n.length;w++){var m=n[w];if(m.footer){var g=m.footer[u];if(angular.isDefined(g)){var v=0!=g.grid,h=0!=g.grouping,C=i&&v||!i&&h;if(C){var x=Object.keys(r.defaultFunctions);angular.isString(g)?g=-1==x.indexOf(g.toLowerCase())?{text:g}:{fn:g.toLowerCase()}:angular.isFunction(g)&&(g={fn:g});var I=g.fn;if(angular.isDefined(I)){var R;if(angular.isFunction(I))R=I(t,m.name);else{if(!angular.isString(I))throw new Error('"renderColumnFooters" : "fn" param passed in a wrong way!');if(-1==x.indexOf(I.toLowerCase()))throw new Error('"renderColumnFooters" : "'+I+'" is not a default function!');var y=I.toUpperCase();g.text=g.text||I.toLowerCase()+" : ","AVG"==y?R=r.defaultFunctions.avg(t,m.name):"COUNT"==y?R=r.defaultFunctions.count(t):"MAX"==y?R=r.defaultFunctions.max(t,m.name):"MIN"==y?R=r.defaultFunctions.min(t,m.name):"SUM"==y&&(R=r.defaultFunctions.sum(t,m.name))}var b=g.format||m.format;if(angular.isDefined(b)&&(R=r.getFormatedValue(R,b)),angular.isDefined(e.options.footerTemplate))d[m.name+"("+u+").text"]=g.text,d[m.name+"("+u+").value"]=R;else if(angular.isDefined(e.options.footerRowTemplate))f[m.name+".text"]=g.text,f[m.name+".value"]=R;else{p=$(o.find("."+a)[c]);var D=$(p.find("."+l).get(w));angular.isDefined(g.align)&&D.css("text-align",g.align),angular.isDefined(g.style)&&D.css(g.style);var E=D.find("."+s);E.empty();var V=$(document.createElement("span"));V.addClass("fn-value"),E.append(V),V.html(R),g.valueRenderer&&(R=g.valueRenderer(V,R));var F=$(document.createElement("span"));F.addClass("fn-text"),F.insertBefore(V),F.html(g.text),g.textRenderer&&(g.text=g.textRenderer(F,g.text))}}else{if(!angular.isDefined(g.text))throw new Error('"renderColumnFooters" : column footer neither has "function" nor "text" property was set!');E.html(g.text)}c++}}}}if(angular.isDefined(e.options.footerRowTemplate)){var H=r.applyTemplateValues(e.options.footerRowTemplate,f);p.html(H),p.css("width","100%")}}if(angular.isDefined(e.options.footerTemplate)){var H=r.applyTemplateValues(e.options.footerTemplate,d);o.html(H)}},r.defaultFunctions={avg:function(e,o){return r.defaultFunctions.sum(e,o)/e.length},count:function(e){return e.length},max:function(e,o){for(var r=Number.MIN_VALUE,n=0;n<e.length;n++){var t=e[n];value=t[o],value>r&&(r=value)}return r},min:function(e,o){for(var r=Number.MAX_VALUE,n=0;n<e.length;n++){var t=e[n];value=t[o],value<r&&(r=value)}return r},sum:function(e,o){for(var r=0,n=0;n<e.length;n++){var t=e[n];r+=t[o]}return r}};r.rowDetailsExpand=function(e,o,r,n){var t=o.find(".ui-cell-inner.row-detail");t.removeClass("expand"),t.addClass("collapse"),o.addClass("row-detail-expanded"),e.managerRendererItems.insertRowDefailtBox(n),e.options.api.repaint()},r.rowDetailsCollapse=function(e,o,r,n){var t=o.find(".ui-cell-inner.row-detail");t.removeClass("collapse"),t.addClass("expand"),o.removeClass("row-detail-expanded"),e.managerRendererItems.removeRowDetailtBox(n),e.options.api.repaint()};r.groupExpand=function(e,o,r,n){var t=o.attr("groupIndex");if(angular.isDefined(t)){t=parseInt(t);for(var i=[],a=(e.options.data,0);a<e.options.data.length;a++){var l=e.options.data[a];l.groupIndex==t&&i.push(a)}e.managerRendererItems.insertChildrenGroup(t,i),e.options.api.repaint()}},r.groupCollapse=function(e,o,r,n){var t=o.attr("groupIndex");angular.isDefined(t)&&(t=parseInt(t),e.managerRendererItems.removeAllChildrenGroup(t),e.options.api.repaint())},r.transformToArrayValue=function(e){var o=[];return e&&(Array.isArray(e)?o=e:o.push(e)),o},r.applyTemplateValues=function(e,o,n){var t=r.prepareForNestedJson(o);angular.extend(t,n);for(var i=Object.keys(t),a=e,l=0;l<i.length;l++)for(var s=i[l],d=t[s],c="{"+s+"}",u=a.indexOf(c);-1!=u;)a=a.replace(c,d),u=a.indexOf(c,u+d.length);return a},r.prepareForNestedJson=function(e){var o={},r=function(e,n){var t="[object Array]"==toString.call(e)?"]":"";for(var i in e)e.hasOwnProperty(i)&&(angular.isObject(e[i])||(o[n+i+t]=e[i]),"[object Array]"==toString.call(e[i])?r(e[i],n+i+t+"["):"[object Object]"==toString.call(e[i])&&r(e[i],n+i+t+"."))};return r(e,""),o},r.isFixedColumn=function(e,o){if(!e.options.fixedCols||!e.options.fixedCols.columns)return!1;for(var r=0;r<e.options.fixedCols.columns.length;r++)if(e.options.fixedCols.columns[r].name==o)return!0},r.format=function(){for(var e=arguments[0],o=1;o<arguments.length;o++){var r=new RegExp("\\{"+(o-1).toString()+"\\}","gi");e=e.replace(r,arguments[o])}return e},r.ManagerRendererItems=function(e){var o=this;o.rowHeight=parseInt(e.options.rowHeight.replace("px","")),o.items=[],o.renderedItems=[],o.createItems=function(){o.items=[];var n=0;if(e.options.api.isGrouped()){for(var t=0;t<e.options.dataGroup.length;t++)if(o.items.push({top:n,height:o.rowHeight,rowIndex:e.options.dataGroup[t].rowIndex,groupIndex:t,children:e.options.dataGroup[t].children}),n+=o.rowHeight,r.hasColumnFooter(e)&&e.columnFooterRowsNumberGrouping>0){var i=e.options.columnGroupingFooterRowHeight;i=parseInt(i.toString().replace("px","")),i*=e.columnFooterRowsNumberGrouping,o.items.push({top:n,height:i,rowIndex:e.options.dataGroup[t].rowIndex,groupIndex:t,children:e.options.dataGroup[t].children,footerContainer:!0}),n+=i}}else for(var a=angular.isDefined(e.options.cardView)?e.options.cardView.numberOfColumns:1,t=0;t<e.options.data.length;)for(var l=0;a>l;l++){if(o.items.push({top:n,height:o.rowHeight,rowIndex:t}),n+=o.rowHeight,e.options.rowDetails&&e.options.rowDetails.autoExpand){var i=e.options.rowDetails.height||50;i=parseInt(i.toString().replace("px","")),o.items.push({top:n,height:i,rowIndex:t,rowDetails:!0}),n+=i}t++}},o.insertRowDefailtBox=function(r){for(var n,t=!1,i=0;i<o.items.length;i++){var a=o.items[i];if(t)a.top=n,a.rendered&&a.rowElement.css("top",n+"px"),n+=a.height;else if(a.rowIndex==r){t=!0,n=a.top+a.height-2;var l=e.options.rowDetails.height||50;l=parseInt(l.toString().replace("px","")),o.items.splice(i+1,0,{top:n,height:l,rowIndex:r,rowDetails:!0}),i++,n+=l}}var s=o.items[o.items.length-1].top+o.rowHeight;e.bodyContainer.height(s),e.fixedColsBodyContainer.height(s)},o.removeRowDetailtBox=function(r){for(var n,t=!1,i=0;i<o.items.length;i++){var a=o.items[i];t?(a.top=n,a.rendered&&a.rowElement.css("top",n+"px"),n+=a.height):a.rowIndex==r&&(t=!0,n=a.top+a.height,e.bodyContainer.find(".ui-row.row-detail-container[rowindex="+r+"]").remove(),o.items.splice(i+1,1))}var l=o.items[o.items.length-1].top+o.rowHeight;e.bodyContainer.height(l),e.fixedColsBodyContainer.height(l)},o.insertChildrenGroup=function(r,n){for(var t,i=!1,a=0;a<o.items.length;a++){var l=o.items[a];if(i)l.top=t,l.rendered&&l.rowElement.css("top",t+"px"),t+=l.height;else if(l.groupIndex==r){i=!0,t=l.top+l.height;for(var s=0;s<n.length;s++)o.items.splice(a+1+s,0,{top:t,height:o.rowHeight,rowIndex:n[s],groupIndex:r,indexInsideGroup:s}),t+=o.rowHeight;a+=n.length}}var d=o.items[o.items.length-1].top+o.rowHeight;e.bodyContainer.height(d),e.fixedColsBodyContainer.height(d)},o.removeAllChildrenGroup=function(r){for(var n,t=!1,i=0;i<o.items.length;i++){var a=o.items[i];if(t)a.top=n,a.rendered&&a.rowElement.css("top",n+"px"),n+=a.height;else if(a.groupIndex==r){for(t=!0,i++;o.items[i].groupIndex==r;){var l=o.items[i];if(l.footerContainer)break;l.rendered&&l.rowElement.remove(),o.items.splice(i,1)}i--,n=a.top+a.height}}var s=o.items[o.items.length-1].top+o.rowHeight;e.bodyContainer.height(s),e.fixedColsBodyContainer.height(s)},o.getVisibleRows=function(){for(var r=[],n=e.bodyViewport.scrollTop(),t=n+e.bodyViewport.height(),i=0;i<o.items.length;i++){var a=o.items[i];a.top+a.height>n&&a.top<t&&r.push(a)}return r},o.removeAllNotVisibleElementsRows=function(e,r){for(var n=0;n<o.items.length;n++){var t=o.items[n];if(t.rendered&&-1==r.indexOf(t)&&!t.footerContainer){var i=".ui-row[rowindex="+t.rowIndex+"]:not(.ui-grouping-footer-container)";e.bodyContainer.find(i).remove(),e.fixedColsBodyContainer.find(i).remove(),t.rendered=!1,t.rowElement=void 0}}},o.getInfoGroup=function(e){for(var r=0;r<o.items.length;r++){var n=o.items[r];if(n.groupIndex==e&&angular.isDefined(n.children))return n}return null},o.getInfoRow=function(e){for(var r=0;r<o.items.length;r++){var n=o.items[r];if(n.rowIndex==e&&!angular.isDefined(n.children))return n}return null},o.adjustElementTop=function(e){e.rowElement.css("top",e.top+"px")}}}),angular.module("ui-deni-grid").controller("uiDeniGridCtrl",function(e,o,r,n){var t=this;if(t.scope=e,t.element=o,t.checkedRecords=[],t.wrapper=t.element.find(".ui-deni-grid-wrapper"),t.viewport=t.wrapper.find(".ui-deni-grid-viewport"),t.container=t.viewport.find(".ui-deni-grid-container"),t.colsViewportWrapper=t.container.find(".ui-variable-cols-viewport-wrapper"),t.colsViewport=t.colsViewportWrapper.find(".ui-viewport"),t.colsContainer=t.colsViewport.find(".ui-container"),t.headerViewportWrapper=t.colsContainer.find(".ui-header-viewport-wrapper"),t.headerViewport=t.headerViewportWrapper.find(".ui-header-viewport"),t.headerContainer=t.headerViewport.find(".ui-header-container"),t.bodyViewportWrapper=t.colsContainer.find(".ui-body-viewport-wrapper"),t.bodyViewport=t.bodyViewportWrapper.find(".ui-body-viewport"),t.bodyContainer=t.bodyViewport.find(".ui-body-container"),t.footerViewportWrapper=t.colsContainer.find(".ui-footer-viewport-wrapper"),t.footerViewport=t.footerViewportWrapper.find(".ui-footer-viewport"),t.footerContainer=t.footerViewport.find(".ui-footer-container"),t.fixedColsViewportWrapper=t.container.find(".ui-fixed-cols-viewport-wrapper"),t.fixedColsViewport=t.fixedColsViewportWrapper.find(".ui-viewport"),t.fixedColsContainer=t.fixedColsViewport.find(".ui-container"),t.fixedColsHeaderViewportWrapper=t.fixedColsContainer.find(".ui-header-viewport-wrapper"),t.fixedColsHeaderViewport=t.fixedColsHeaderViewportWrapper.find(".ui-header-viewport"),t.fixedColsHeaderContainer=t.fixedColsHeaderViewport.find(".ui-header-container"),t.fixedColsBodyViewportWrapper=t.fixedColsContainer.find(".ui-body-viewport-wrapper"),t.fixedColsBodyViewport=t.fixedColsBodyViewportWrapper.find(".ui-body-viewport"),t.fixedColsBodyContainer=t.fixedColsBodyViewport.find(".ui-body-container"),t.fixedColsFooterViewportWrapper=t.fixedColsContainer.find(".ui-footer-viewport-wrapper"),t.fixedColsFooterViewport=t.footerViewportWrapper.find(".ui-footer-viewport"),t.fixedColsFooterContainer=t.footerViewport.find(".ui-footer-container"),n.setDefaultOptions(t,t.options),t.options.fixedCols?(t.fixedColsViewportWrapper.css("width",t.options.fixedCols.width+"px"),t.colsViewportWrapper.css("width","calc(100% - "+t.fixedColsViewportWrapper.css("width")+")")):(t.fixedColsViewportWrapper.css("display","none"),t.colsViewportWrapper.css("width","100%")),t.clientWidth=n.getClientWidthDeniGrid(t),t.options.hideHeaders?(t.headerViewportWrapper.css("display","none"),t.fixedColsHeaderViewportWrapper.css("display","none")):(t.columnHeaderLevels=n.getColumnHeaderLevels(t,t.options.columns),r.createColumnHeaders(t,t.options.columns),r.createColumnHeadersEvents(t),t.headerViewportWrapper.css("height","calc("+t.options.columnHeaderHeight+" * "+t.columnHeaderLevels+")"),t.fixedColsHeaderViewportWrapper.css("height","calc("+t.options.columnHeaderHeight+" * "+t.columnHeaderLevels+")")),t.columnFooterRowsNumberGrid=n.getColumnFooterRowsNumber(t),t.columnFooterRowsNumberGrouping=n.getColumnFooterRowsNumber(t,!0),t.columnFooterNumber=n.getColumnFooterNumber(t),n.hasColumnFooter(t)&&t.columnFooterRowsNumberGrid>0){n.createColumnFooters(t,t.footerContainer,t.options.columns,!0);var i=(t.footerContainer.find(".ui-footer-row").length,angular.isDefined(t.options.footerRowTemplate)?"0px":"2px");t.footerViewportWrapper.css({"padding-top":i})}else t.footerViewportWrapper.css("display","none"),t.fixedColsFooterViewportWrapper.css("display","none");t.searchInfo=null,t.searching=!1,t.resizing=!1,t.managerRendererItems=new n.ManagerRendererItems(t),r.createUiDeniViewEvents(t),t.options.api={clearSelections:function(){r.clearSelections(t)},find:function(e,o){return r.find(t,e,o)},findFirst:function(e,o){return r.findFirst(t,e,o)},findKey:function(e){return r.findKey(t,valuesToFind,opts)},findLast:function(e,o){return r.findLast(t,e,o)},findNext:function(e,o){return r.findNext(t,e,o)},findPrevious:function(e,o){return r.findPrevious(t,e,o)},filter:function(e,o){return r.filter(t,e,o)},getChangedRecords:function(){return r.getChangedRecords(t)},getColumn:function(e){return r.getColumn(t,e)},getRowHeight:function(){return r.getRowIndex(t)},getRowIndex:function(e){return r.getRowIndex(t,e)},getSelectedRow:function(){return r.getSelectedRow(t)},getSelectedRowIndex:function(){return r.getSelectedRowIndex(t)},isEnableGrouping:function(){return r.isEnableGrouping(t)},isGrouped:function(){return r.isGrouped(t)},isRowSelected:function(e){return r.isRowSelected(t,e)},isRowVisible:function(e){return r.isRowVisible(t,e)},load:function(){r.load(t)},loadData:function(e){r.loadData(t,e)},isHideHeaders:function(){return r.isHideHeaders(t)},resolveRowElement:function(e){return r.resolveRowElement(t,e)},resolveRowIndex:function(e){return r.resolveRowIndex(t,e)},repaint:function(){r.repaint(t)},repaintRow:function(e){return r.repaintRow(t,e)},setDisableGrouping:function(){r.setDisableGrouping(t)},setEnableGrouping:function(){r.setEnableGrouping(t)},setHideHeaders:function(e){return r.setHideHeaders(t,e)},selectAll:function(){r.selectAll(t)},selectRow:function(e,o,n){r.selectRow(t,e,o,n)},setRowHeight:function(e){r.setRowHeight(t,e)},setToogleGrouping:function(){r.setToogleGrouping(t)},sort:function(e,o){return t.options.sorters=r.sort(t,e,o)},updateSelectedRow:function(e){r.updateSelectedRow(t,e)},updateSelectedCell:function(e){r.updateSelectedCell(t,e)}},n.remakeHeightBodyViewportWrapper(t),t.options.data?t.options.api.loadData(t.options.data):t.options.url&&t.options.autoLoad&&t.options.api.load()}),angular.module("ui-deni-grid").service("uiDeniGridSrv",function($compile,$timeout,$templateCache,$q,$http,$filter,uiDeniGridUtilSrv,uiDeniGridConstants){var me=this;me.clearSelections=function(e){e.bodyViewport.find(".ui-row.selected").removeClass("selected"),e.fixedColsBodyViewport.find(".ui-row.selected").removeClass("selected"),e.bodyViewport.find(".ui-cell.selected").removeClass("selected"),e.fixedColsBodyViewport.find(".ui-cell.selected").removeClass("selected")},me.selectAll=function(e){if(!e.options.multiSelect)throw new Error('"selectAll" : to use selectAll method you must set multiSelect property to true!');e.bodyViewport.find(".ui-row.selected").addClass("selected"),e.bodyViewport.find(".ui-cell.selected").addClass("selected")},me.createColumnHeaders=function(e,o,r,n,t){var i=[],a=function(o){var r=$(document.createElement("div"));return r.addClass("ui-header-container-column-row"),r.css("height",e.options.columnHeaderHeight),o.append(r),r};e.options.fixedCols?(angular.copy(o,i),e.options.fixedCols.rowNumber&&i.splice(0,0,{width:uiDeniGridConstants.FIXED_COL_ROWNUMBER_WIDTH,isFixedColumn:!0}),e.options.fixedCols.indicator&&i.splice(0,0,{width:uiDeniGridConstants.FIXED_COL_INDICATOR_WIDTH,isFixedColumn:!0}),e.options.fixedCols.checkbox&&i.splice(0,0,{width:uiDeniGridConstants.FIXED_COL_CHECKBOX_WIDTH,isFixedColumn:!0,isCheckbox:!0})):i=o;for(var l=r?r.width():e.clientWidth,s=n||1,d=t||0,c=0;c<i.length;c++){var u=i[c],p=$(document.createElement("div"));p.css("width",uiDeniGridUtilSrv.getRealColumnWidth(e,u.width,l)),p.addClass("ui-header-container-column"),p.attr("colindex",d),angular.isDefined(r)&&(0==c?p.addClass("first-subcolumn"):c==i.length-1&&p.addClass("last-subcolumn"));var f=f=a(p),w=$(document.createElement("div"));w.addClass("ui-header-cell"),w.attr("colindex",d),w.attr("name",u.name),w.css("text-align",u.align),f.append(w);var m=$(document.createElement("span"));if(m.addClass("ui-header-cell-inner"),w.append(m),u.isCheckbox){var g=$(document.createElement("input"));g.attr("type","checkbox"),g.css({cursor:"pointer"}),w.css({"text-align":"center"}),m.append(g),g.change(function(o){for(var r=e.fixedColsBodyContainer.find(".ui-cell-inner.checkbox").find("input[type=checkbox]"),n=0;n<r.length;n++)r[n].checked=o.target.checked})}else{var v=u.header||u.name;m.html(v)}if(angular.isDefined(r)?r.append(p):u.isFixedColumn||uiDeniGridUtilSrv.isFixedColumn(e,u.name)?e.fixedColsHeaderContainer.append(p):e.headerContainer.append(p),e.columnHeaderLevels>1)if(u.columns){p.addClass("has-subcolumns"),w.addClass("has-subcolumns"),f=a(p),me.createColumnHeaders(e,u.columns,f,s+1,d);var h=f.find(".ui-header-container-column.last-subcolumn");d=h.attr("colIndex")}else if(s<e.columnHeaderLevels){var C=f.css("height"),x=e.columnHeaderLevels-s,I="calc("+C+" + ("+e.options.columnHeaderHeight+" * "+x+"))";f.css({height:I})}d++}},me.createColumnHeadersEvents=function(e){var o,r,n=!1,t=function(){void 0==o&&(o=document.createElement("hr"),o.classList.add("ui-deni-grid-vertical-line-resizing"),e.colsViewport.append(o));var r=event.pageX-e.colsViewport.offset().left;$(o).css({display:"block",left:r,height:e.colsViewport.height()+"px"})},i=function(){e.resizing=!1,r=null,e.colsViewport.css("cursor","default"),o&&$(o).css("display","none")};e.headerContainer.mousedown(function(o){headerContainerColumn=$(o.target).closest(".ui-header-container-column"),headerContainerColumn.length>0&&n&&(e.resizing=!0),o.preventDefault()});var a=function(e,o){var r=e.parents(".ui-header-container-column:eq(0)");if(r.length>0){var n=r.find(".ui-header-container-column"),t=n.length;return r.width(r.width()+o-t),a(r,o)}return e};$(document).mouseup(function(o){if(e.resizing){if(r){var n=r.getBoundingClientRect().left+r.clientWidth,t=o.pageX-n;$headerContainerColumnResizing=$(r);var l=$headerContainerColumnResizing.width()+t;if($headerContainerColumnResizing.is(".has-subcolumns")){var s=$headerContainerColumnResizing.find(".ui-header-container-column.last-subcolumn"),d=s.width();$headerContainerColumnResizing.width(l);var c=1;s.width(d+t+c),uiDeniGridUtilSrv.adjustColumnWidtsAccordingColumnHeader(e,s,s.attr("colindex"))}else{a($headerContainerColumnResizing,t);$headerContainerColumnResizing.width(l),uiDeniGridUtilSrv.adjustColumnWidtsAccordingColumnHeader(e,$headerContainerColumnResizing,$headerContainerColumnResizing.attr("colindex"))}}i()}e.colsViewport.css("cursor","default"),o.preventDefault()});var l=function(e,o,r){var n;return function(){var t=this,i=arguments,a=function(){n=null,r||e.apply(t,i)},l=r&&!n;clearTimeout(n),n=setTimeout(a,o),l&&e.apply(t,i)}};$(document).mousemove(function(o){if(e.options.enableColumnResize)if(1===o.which)e.resizing&&l(t(),100);else if(0===o.which&&(e.colsViewport.css("cursor","default"),headerContainerColumn=$(o.target).closest(".ui-header-container-column"),headerContainerColumn.length>0)){var i=e.headerContainer.find(".ui-header-cell");n=!1,r=null;for(var a=0;a<i.length;a++){var s=i[a],d=s.getBoundingClientRect();if(o.clientX>d.right-5&&o.clientX<d.right+3){n=!0,e.colsViewport.css("cursor","col-resize"),r=s.closest(".ui-header-container-column");break}}}o.preventDefault()});for(var s=e.headerContainer.find(".ui-header-cell"),d=0;d<s.length;d++){var c=$(s[d]);c.mouseenter(function(e){$(e.currentTarget).addClass("hover")}),c.mouseleave(function(e){$(e.currentTarget).removeClass("hover")}),c.mouseup(function(o){if(1===o.which&&"default"==e.colsViewport.css("cursor")&&e.options.sortableColumns){var r=$(o.currentTarget),n="ASC";r.is(".asc")&&(n="DESC");var t=$(o.target.closest(".ui-header-container-column"));t.is(".has-subcolumns")||e.options.api.sort({name:r.attr("name"),direction:n})}})}};var _sort=function(e,o){var r;if(angular.isString(o))r=[{name:o,direction:"ASC"}];else if(angular.isObject(o))r=angular.isArray(o)?o:[o];else{if(!angular.isFunction(o))throw new Error('"sort": param "sorters" passed in a wrong way');r=[o]}if(e.options.data){var n=function(o){for(var r=0;r<o.length;r++){var n=o[r],t=n.direction||"ASC";e.options.data=$filter("orderBy")(e.options.data,n.name,"DESC"==t.toUpperCase())}};e.options.fixedSorters&&n(e.options.fixedSorters),n(r)}return r};me.sort=function(e,o,r){var n;0!=r&&(n=me.getSelectedRow(e)),e.headerContainer.find("div.ui-header-cell").removeClass("sort").removeClass("asc").removeClass("desc");var t;if(e.options.api.isGrouped())t=_sort(e,o),e.bodyContainer.find(".ui-row.collapse").filter(function(){var o=$(this),r=(parseInt(o.attr("groupIndex")),parseInt(o.attr("rowindex"))),n=e.options.data[r];uiDeniGridUtilSrv.groupCollapse(e,o,n,r),uiDeniGridUtilSrv.groupExpand(e,o,n,r)});else if(e.options.rowDetails){var i=[];e.bodyContainer.find(".ui-row.row-detail-expanded").filter(function(){var o=parseInt($(this).attr("rowindex")),r=e.options.data[o];i.push(r)});t=_sort(e,o),e.options.api.loadData(e.options.data);for(var a=0;a<i.length;a++){var l=i[a],s=e.options.api.resolveRowIndex(l),d=e.options.api.resolveRowElement(s);uiDeniGridUtilSrv.rowDetailsExpand(e,d,l,s)}e.options.api.repaint()}else t=_sort(e,o),e.options.api.loadData(e.options.data);for(var a=0;a<t.length;a++){var c=t[a];if(!angular.isFunction(c)){var u=$(_getHeaderColElementByName(e,c.name,!0));u.addClass("sort"),u.addClass(c.direction?c.direction.toLowerCase():"asc")}}return n&&me.selectRow(e,n),t};var _getHeaderColElementByName=function(e,o,r){var n=e.headerContainer.find('div.ui-header-cell[name="'+o+'"]');if(0==n.length){if(r)throw new Error('There is not a columns with a name "'+o+'"!');return null}return n[0]},_rendererRealcedCells=function(e,o,r){var n=Object.keys(r.valuesToFind);if(-1==n.indexOf(e))return o;var t=r.valuesToFind[e],i=o.indexOf(t);if(-1==i)return o;for(var a=r.opts.inLine.realce,l="",s=i;-1!=i;){l+=o.substring(o,i);var d=o.substring(i,i+t.length),c='<span style="'+a.style+'">'+d+"</span>";l+=c,s=i+c.length,i=o.indexOf(t,s)}return l},_createDivCell=function(e,o){var r=$(document.createElement("div"));return r.addClass("ui-cell"),o.is(".row-detail")||(r.mouseenter(function(r){"row"==e.options.selType?(e.bodyViewport.find(".ui-row[rowindex="+o.attr("rowindex")+"]:not(.row-detail)").find(".ui-cell").addClass("hover"),e.fixedColsBodyViewport.find(".ui-row[rowindex="+o.attr("rowindex")+"]:not(.row-detail)").find(".ui-cell").addClass("hover")):$(r.currentTarget).addClass("hover")}),r.mouseleave(function(r){e.bodyViewport.find(".ui-row[rowindex="+o.attr("rowindex")+"]").find(".ui-cell").removeClass("hover"),e.fixedColsBodyViewport.find(".ui-row[rowindex="+o.attr("rowindex")+"]").find(".ui-cell").removeClass("hover")}),r.mousedown(function(o){if(1===o.which)if("row"==e.options.selType){var r=$(o.currentTarget),n=r.closest(".ui-row");parseInt(n.attr("rowindex"));me.selectRow(e,n)}else{var r=$(o.currentTarget),t=parseInt(r.attr("colIndex")),n=r.closest(".ui-row");parseInt(n.attr("rowindex"));me.selectCell(e,n,t)}}),r.dblclick(function(o){var r=$(o.currentTarget),n=parseInt(r.attr("colIndex")),t=e.options.columns[n];if(t.editor){var i=r.closest(".ui-row"),a=parseInt(i.attr("rowindex")),l=e.options.data[a];uiDeniGridUtilSrv.setInputEditorDivCell(e,l,t,r)}})),o.append(r),r},_createDivCellInner=function(e){var o=$(document.createElement("span"));return o.addClass("ui-cell-inner"),e.append(o),o};me.createUiDeniViewEvents=function(controller){controller.options.listeners.onrenderer=function(rowElement,fixedRowElement,record,rowIndex,viewController){if(angular.isDefined(controller.options.rowTemplate)){var divCell=_createDivCell(controller,rowElement);rowElement.css("width","100%"),divCell.css("width","100%"),valueToRender=uiDeniGridUtilSrv.applyTemplateValues(controller.options.rowTemplate,record),
divCell.html(valueToRender)}else if(rowElement.is(".row-detail")){var divCell=_createDivCell(controller,rowElement);divCell.addClass("row-detail");var spanCellInner=_createDivCellInner(divCell);spanCellInner.addClass("row-detail"),spanCellInner.addClass("expand"),spanCellInner.css("cursor","pointer"),spanCellInner.click(function(e){spanCellInner.toggleClass("expand collapse"),rowElement.toggleClass("expand collapse"),spanCellInner.is(".collapse")?uiDeniGridUtilSrv.groupExpand(controller,rowElement,record,rowIndex):uiDeniGridUtilSrv.groupCollapse(controller,rowElement,record,rowIndex)});var valueToRender;if(controller.options.grouping.template){var totalRowsInGroup=parseInt(rowElement.attr("children")||0);valueToRender=uiDeniGridUtilSrv.applyTemplateValues(controller.options.grouping.template,record,{count:totalRowsInGroup})}spanCellInner.html(valueToRender)}else if(rowElement.is(".ui-grouping-footer-container")){var columns=controller.options.columns,totalRowsInGroup=parseInt(rowElement.attr("children")||0),records=controller.options.data.slice(rowIndex,rowIndex+totalRowsInGroup);uiDeniGridUtilSrv.createColumnFooters(controller,rowElement,columns,!1),uiDeniGridUtilSrv.renderColumnFooters(controller,rowElement,columns,records,!1)}else for(var isRowSelected=rowElement.is(".selected"),columns=me.getColumns(controller,controller.options.columns),colIndex=0,index=0;index<columns.length;index++){if(0==index&&controller.options.fixedCols){if(controller.options.fixedCols.checkbox){var divCellIndicator=_createDivCell(controller,fixedRowElement);divCellIndicator.css("width",uiDeniGridConstants.FIXED_COL_CHECKBOX_WIDTH),divCellIndicator.addClass("auxiliar-fixed-column");var spanCellIndicatorInner=_createDivCellInner(divCellIndicator);spanCellIndicatorInner.addClass("checkbox");var inputCheck=$(document.createElement("input"));inputCheck.attr("type","checkbox"),inputCheck.css({cursor:"pointer"}),spanCellIndicatorInner.append(inputCheck),colIndex++}if(controller.options.fixedCols.indicator){var divCellIndicator=_createDivCell(controller,fixedRowElement);divCellIndicator.css("width",uiDeniGridConstants.FIXED_COL_INDICATOR_WIDTH),divCellIndicator.addClass("auxiliar-fixed-column");var spanCellIndicatorInner=_createDivCellInner(divCellIndicator);spanCellIndicatorInner.addClass("indicator"),colIndex++}if(controller.options.fixedCols.rowNumber){var divCellRowNumber=_createDivCell(controller,fixedRowElement);divCellRowNumber.css("width",uiDeniGridConstants.FIXED_COL_ROWNUMBER_WIDTH),divCellRowNumber.addClass("auxiliar-fixed-column");var spanCellRowNumberInner=_createDivCellInner(divCellRowNumber);spanCellRowNumberInner.addClass("rownumber"),spanCellRowNumberInner.html(rowIndex+1),colIndex++}}var column=columns[index],divCell;divCell=uiDeniGridUtilSrv.isFixedColumn(controller,column.name)?_createDivCell(controller,fixedRowElement):_createDivCell(controller,rowElement);var spanCellInner=_createDivCellInner(divCell);0==index&&controller.options.rowDetails&&(spanCellInner.addClass("row-detail"),controller.options.rowDetails.autoExpand===!0?spanCellInner.addClass("collapse"):spanCellInner.addClass("expand"),spanCellInner.click(function(e){if(e.offsetX<=12){var o=$(e.target);o.is(".collapse")?uiDeniGridUtilSrv.rowDetailsCollapse(controller,rowElement,record,rowIndex):uiDeniGridUtilSrv.rowDetailsExpand(controller,rowElement,record,rowIndex)}}));var style=column.style||{};divCell.css(angular.extend(style,{"text-align":column.align||"left"})),0==index&&controller.options.api.isGrouped()&&divCell.css("padding-left","20px");var value=eval("record."+column.name);column.renderer&&(value=column.renderer(value,record,columns,rowIndex));var formattedValue=value;angular.isDefined(column.format)&&(formattedValue=uiDeniGridUtilSrv.getFormatedValue(value,column.format)),isRowSelected&&controller.searchInfo&&(formattedValue=_rendererRealcedCells(column.name,formattedValue,controller.searchInfo)),spanCellInner.html(formattedValue),divCell.attr("colIndex",colIndex),colIndex++}},controller.options.listeners.onbeforeload=function(e,o){uiDeniGridUtilSrv.hasColumnFooter(controller)&&(uiDeniGridUtilSrv.renderColumnFooters(controller,controller.footerContainer,controller.options.columns,e,!0),uiDeniGridUtilSrv.remakeHeightBodyViewportWrapper(controller))},controller.options.listeners.onafterload=function(e,o){uiDeniGridUtilSrv.remakeHeightBodyViewportWrapper(controller)},controller.options.listeners.onafterexpand=function(e,o,r,n){if(e.length>0){var t=controller.options.api.resolveRowIndex(e[0]);me.selectRow(controller,t)}if(uiDeniGridUtilSrv.hasColumnFooter(controller)){var i=r.prop("footer");if(angular.isDefined(i))i.css("display","block");else{var i=$(document.createElement("div"));i.addClass("ui-deni-grid-grouping-footer-container"),r.prop("footer",i),i.insertAfter(n),uiDeniGridUtilSrv.renderColumnFooters(i,controller.footerContainer,controller.options.columns,e,controller)}}},controller.options.listeners.onafterrepaint=function(e){if(!controller.options.hideHeaders){for(var o=0,r=controller.fixedColsHeaderContainer.find(".ui-header-container-column:not(.has-subcolumns)"),n=0;n<r.length;n++){var t=$(r[n]);uiDeniGridUtilSrv.adjustColumnWidtsAccordingColumnHeader(controller,t,o),o++}for(var r=controller.headerContainer.find(".ui-header-container-column:not(.has-subcolumns)"),n=0;n<r.length;n++){var t=$(r[n]);uiDeniGridUtilSrv.adjustColumnWidtsAccordingColumnHeader(controller,t,o),o++}}},controller.bodyViewport.scroll(function(e){var o=$(this).scrollLeft();if(controller.bodyViewport.currentScrollLeft===o){controller.bodyViewport.currentScrollTop=$(this).scrollTop();var r=controller.bodyViewport.find(".ui-row:eq(0)");if(r.length>0){var n=(r.get(0).getBoundingClientRect().top,-1*controller.bodyViewport.currentScrollTop+"px");controller.options.fixedCols&&controller.fixedColsBodyContainer.css("top",n)}}else{controller.bodyViewport.currentScrollLeft=o;var r=controller.bodyViewport.find(".ui-row:eq(0)");if(r.length>0){var t=(r.get(0).getBoundingClientRect().left,-1*controller.bodyViewport.currentScrollLeft+"px");controller.headerContainer.css("left",t),controller.footerDivContainer.find(".ui-deni-grid-footer").css("left",t)}}controller.options.api.repaint()})},me.getSelectedRow=function(e){return void 0===e.rowIndex?null:e.options.data[e.rowIndex]},me.getChangedRecords=function(e){for(var o=e.bodyViewport.find("div.ui-row.changed"),r=e.options.data,n=[],t=0;t<o.length;t++){var i=$(o[t]).attr("rowindex"),a=r[i];n.push(a)}return n};var _resolveJavaScriptElement=function(e){return angular.isElement(e)?e.get(0):e},_resolveJQueryElement=function(e){return angular.isElement(e)?e:$(e)},_resolveRecord=function(e,o){return angular.isObject(o)?o:e.options.data[o]};me.isRowSelected=function(e,o){var r=e.options.api.resolveRowElement(o);return r.is(".selected")},me.getSelectedRowIndex=function(e){var o=e.bodyViewport.find("div.ui-row.selected");if(0==o.length)return-1;if(1==o.length)return parseInt($(o[0]).attr("rowindex"));if(o.length>1){for(var r=[],n=0;n<o.length;n++)r.push(parseInt($(o[n]).attr("rowindex")));return r}},me.selectRow=function(e,o,r,n){if(!(e.options.data&&e.options.data.length>0))throw new Error('"selectRow": There is not record to select!');var t;if(angular.isElement(o))t=o,e.rowIndex=parseInt(t.attr("rowindex"));else{var i;if(i=e.options.api.isGrouped()?e.options.api.resolveRowIndex(o):e.options.api.resolveRowIndex(o),n=0!=n,-1==i)throw new Error("selectRow: row passed in a wrong way!");if(me.isRowSelected(e,i))scrollIntoViewFn(i);else if(e.rowIndex=i,e.options.api.isGrouped()){var a=e.managerRendererItems.getInfoRow(i);if(!a){var l=e.options.data[i].groupIndex,s=e.managerRendererItems.getInfoGroup(l);e.colsViewport.scrollTop(s.top),e.options.api.repaint();var d=e.options.data[i];uiDeniGridUtilSrv.groupExpand(e,s.rowElement,d,i),a=e.managerRendererItems.getInfoRow(i)}e.colsViewport.scrollTop(a.top),e.options.api.repaint(),t=a.rowElement}else{var c=parseInt(e.options.rowHeight.replace("px","")),u=i*c-10;e.bodyViewport.scrollTop(u),e.options.api.repaint();var a=e.managerRendererItems.getInfoRow(i);t=a.rowElement}}if(void 0===e.rowIndex||e.options.multiSelect||e.options.api.clearSelections(),e.bodyViewport.find(".ui-row[rowindex="+t.attr("rowindex")+"]:not(.row-detail)").find(".ui-cell").addClass("selected"),e.fixedColsBodyViewport.find(".ui-row[rowindex="+t.attr("rowindex")+"]:not(.row-detail)").find(".ui-cell").addClass("selected"),e.options.fixedCols){var p=e.fixedColsBodyContainer.find(".ui-fixed-row[rowindex="+t.attr("rowindex")+"]:not(.row-detail)");p.addClass("selected"),p.find(".ui-cell.indicator").addClass("selected")}e.options.rowDetails&&t.parent().find(".ui-row.row-detail-container[rowIndex="+t.attr("rowindex")+"]").addClass("selected"),r||e.options.listeners.onselectionchange&&e.options.listeners.onselectionchange(e,e.element,e.rowIndex,e.options.data[e.rowIndex])},me.selectCell=function(e,o,r,n,t){if(e.options.data&&e.options.data.length>0){t=0!=t;var i=e.options.api.resolveRowElement(o);if(0==o.length)throw new Error("selectCell: row passed in a wrong way!");var a=i.find(".ui-cell[colIndex="+r+"]");if(0==a.length)throw new Error("selectCell: colIndex passed in a wrong way!");e.options.multiSelect||e.options.api.clearSelections(),a.addClass("selected");var l=e.options.api.resolveRowIndex(o);e.rowIndex=l,e.colIndex=r}},me.getColumns=function(e,o){for(var r=[],n=0;n<o.length;n++){var t=o[n];t.columns?r=r.concat(me.getColumns(e,t.columns)):r.push(t)}return r},me.getColumn=function(e,o){for(var r=0;r<e.options.columns.length;r++)if(e.options.columns[r].name==o)return e.options.columns[r];return null},me.updateSelectedRow=function(controller,json){if(void 0===controller.rowIndex)throw"You have to select a record";for(var fieldsNotNested=uiDeniGridUtilSrv.prepareForNestedJson(json),keyFieldsToChange=Object.keys(fieldsNotNested),index=0;index<keyFieldsToChange.length;index++){var fieldNameToChange=keyFieldsToChange[index],column=controller.options.api.getColumn(fieldNameToChange);if(column){var colIndex=controller.options.columns.indexOf(column),newValue=eval("json."+fieldNameToChange);me.updateCell(controller,controller.rowIndex,colIndex,newValue)}else console.warn('"updateSelectedRow" : field "'+fieldNameToChange+'" not found!')}},me.updateSelectedCell=function(e,o){if(!angular.isDefined(e.rowIndex)||!angular.isDefined(e.colIndex))throw"You have to select a record";me.updateCell(e,e.rowIndex,e.colIndex,o)},me.updateCell=function(e,o,r,n){var t=e.options.api.resolveRowElement(o),i=t.find(".ui-cell[colIndex="+r+"]"),a=i.find(".ui-cell-inner");a.html(n),i.addClass("changed"),i.closest(".ui-row").addClass("changed")},me.isHideHeaders=function(e){return e.options.hideHeaders},me.setHideHeaders=function(e,o){var r;r=o?"none":"block",e.colsViewport.find(".ui-header-viewport").css("display",r),e.options.hideHeaders=o},me.load=function(e){e.bodyViewport.addClass("loading-data"),document.title="loading-data";var o=$q.defer();return e.options.url?$http.get(e.options.url).then(function(r){e.options.api.loadData(r.data),o.resolve(r.data),e.bodyViewport.removeClass("loading-data"),document.title=""},function(e){o.reject(e.statusText)}):o.reject('"load" : To use load function is necessary set the url property.'),o.promise},me.loadData=function(controller,data){controller.options.listeners.onbeforeload&&controller.options.listeners.onbeforeload(data,controller.options),controller.renderedIndexes=[],controller.options.data=data,controller.groupRecords=[],controller.options.dataGroup=[],controller.bodyContainer.find(".ui-row").remove(),controller.fixedColsBodyContainer.find(".ui-row").remove();var rowHeight=parseInt(controller.options.rowHeight.replace("px",""));controller.rowsPerPage=parseInt(controller.bodyViewport.height()/rowHeight)+1;var limitLength=data.length<controller.rowsPerPage?data.length:controller.rowsPerPage;if(controller.options.api.isGrouped()){var expressionToGroup=controller.options.grouping.expr,getEvalFieldValue=function(record,fieldName){return eval("record."+fieldName)},getEvalExpressionValue=function(record,expression){var evalStr="(function() {\n		with (record) {\n				return "+expression+"\n		}\n})()";return eval(evalStr)},fieldsNotNested=uiDeniGridUtilSrv.prepareForNestedJson(controller.options.data[0]),fields=Object.keys(fieldsNotNested),functionToEvaluate;functionToEvaluate=fields.indexOf(controller.options.grouping.expr)?getEvalFieldValue:getEvalExpressionValue,controller.options.data=$filter("orderBy")(controller.options.data,expressionToGroup),controller.options.fixedSorters=[{name:expressionToGroup,direction:"ASC"}];for(var oldValue,recordGroup,groupIndex=-1,index=0;index<controller.options.data.length;index++){var record=controller.options.data[index],value=functionToEvaluate(record,expressionToGroup);oldValue==value?recordGroup.children++:(oldValue=value,groupIndex++,recordGroup=record,recordGroup.children=1,controller.options.dataGroup.push(record)),record.groupIndex=groupIndex,record.rowIndex=index}controller.bodyContainer.height(controller.options.dataGroup.length*rowHeight+2),controller.options.fixedCols&&controller.fixedColsBodyContainer.height(controller.bodyContainer.height())}else{var heightBodyContainer;heightBodyContainer=controller.options.cardView?Math.ceil(controller.options.data.length/controller.options.cardView.numberOfColumns)*rowHeight:controller.options.data.length*rowHeight,controller.bodyContainer.height(heightBodyContainer+2),controller.options.fixedCols&&controller.fixedColsBodyContainer.height(controller.bodyContainer.height())}controller.managerRendererItems.createItems(),me.repaint(controller),controller.options.listeners.onafterload&&controller.options.listeners.onafterload(data,controller.options)},me.find=function(controller,valuesToFind,opts){var data=controller.options.data||[];valuesToFind=valuesToFind||{};var keys=Object.keys(valuesToFind);if(0==data.length)throw new Error('"Find" : There is no data to find!');if(0==keys.length)throw new Error('"Find" : param "valuesToFind" must be informed!');opts=opts||{};var exactSearch=0!=opts.exactSearch,all=1==opts.all,ignoreCase=1==opts.ignoreCase,recordsFound=all?[]:null,breakParentLoop=!1,newJson=uiDeniGridUtilSrv.prepareForNestedJson(valuesToFind);keys=Object.keys(newJson);for(var found=!1,index=0;index<data.length;index++){for(var record=data[index],foundRecord=!1,fieldIndex=0;fieldIndex<keys.length;fieldIndex++){var fieldName=keys[fieldIndex],valueToFind=valuesToFind[fieldName],value=eval("record."+fieldName),valueIsString=angular.isString(value);ignoreCase&&valueIsString&&(valueToFind=valueToFind.toLowerCase(),value=value.toLowerCase()),foundRecord=exactSearch||!valueIsString?valueToFind==value:-1!=value.indexOf(valueToFind)}if(foundRecord){if(found=!0,!all)return record;recordsFound.push(record)}}if(found&&opts.inLine){var inLineDefaultValue={realce:!1},inLine;if(opts.inLine===!0)inLine=inLineDefaultValue;else{if(!angular.isObject(opts.inLine))throw new Error('"find": param "inLine" passed in a wrong way');inLine=opts.inLine}var inLineRealceDefaultValue={style:"background-color:#FFFF00;color:black;padding:1px;"},inLineRealce;inLine.realce&&(1==inLine.realce?inLine.realce=inLineRealceDefaultValue:(inLine.realce=opts.inLine.realce,inLine.realce.style=inLine.realce.style||inLineRealceDefaultValue.style)),inLine.scrollIntoView=0!=inLine.scrollIntoView,controller.searchInfo={valuesToFind:valuesToFind,opts:opts};var selectAndRemoveRendered=function(e,o,r){controller.options.api.selectRow(e,o,r);var n=controller.options.api.resolveRowElement(e);n.attr("rendered",!1)};if(controller.options.api.clearSelections(),Array.isArray(recordsFound))if(controller.options.multiSelect)for(var index=0;index<recordsFound.length;index++)selectAndRemoveRendered(recordsFound[index],0!=index,0==index);else recordsFound.length>1&&console.warn('"find": More than one record was returned, but as the "inLine" property is true and "multiSelect" is false, just the first record will be selected.'),selectAndRemoveRendered(recordsFound[0],!1,!0);else null!=recordsFound&&selectAndRemoveRendered(recordsFound,preventSelecionChange,scrollIntoView);controller.options.api.repaint()}return recordsFound},me.getRowHeight=function(e){return e.options.rowHeight},me.setRowHeight=function(e,o){var r=e.bodyViewport.find("div.ui-row:not(.grouping-footer-container)");r.css("height",e.options.rowHeight)},me.getRowElement=function(e,o){var r=_resolveRowIndex(o);return me.bodyViewport.find("div.ui-row[rowIndex="+r+"]")};var _recreateAll=function(e){e.options.data&&(e.bodyViewport.find("div.ui-deni-view-group-header").remove(),e.bodyViewport.find("div.ui-row").remove(),me.loadData(e,e.options.data))};me.toogleGrouping=function(e){e.options.enableGrouping=!e.options.enableGrouping,_recreateAll(e)},me.isEnableGrouping=function(e){return e.options.enableGrouping},me.isGrouped=function(e){return e.isGrouped},me.setEnableGrouping=function(e){e.options.enableGrouping=!0,_recreateAll(e)},me.setDisableGrouping=function(e){e.options.enableGrouping=!1,_recreateAll(e)};var _renderRowEl=function(e,o,r){var n=$(document.createElement("div"));n.addClass("ui-row"),n.attr("rowindex",o.rowIndex.toString()),n.css("left","0px");var t;if(e.options.fixedCols&&(t=$(document.createElement("div")),t.addClass("ui-row"),t.attr("rowindex",o.rowIndex.toString()),t.css("left","0px"),e.fixedColsBodyContainer.append(t)),o.rowDetails){var i=e.bodyContainer.find(".ui-row[rowIndex="+o.rowIndex+"]:not(.row-detail-container)");n.insertAfter(i);var a=i.find(".ui-cell:eq(0)").is(".selected");a&&n.addClass("selected"),n.addClass("row-detail-container");var l=$(document.createElement("div"));l.addClass("row-detail-box"),n.append(l);var i=e.options.api.resolveRowElement(o.rowIndex);if(n.css("height",o.height+"px"),n.css("top",o.top+"px"),n.insertAfter(i),n.click(function(){e.options.api.selectRow(i)}),o.rowElement=n,e.options.rowDetails.template){var s=uiDeniGridUtilSrv.applyTemplateValues(e.options.rowDetails.template,r);o.rowElement.html(s)}else e.options.rowDetails.renderer&&e.options.rowDetails.renderer(o.rowElements,r)}else e.bodyContainer.append(n),n.css("height",o.height),n.css("top",o.top+"px"),e.options.fixedCols&&(t.css("height",o.height+"px"),t.css("top",o.top+"px")),angular.isDefined(o.children)?(o.footerContainer?n.addClass("ui-grouping-footer-container"):(n.addClass("row-detail"),n.addClass("grouping")),n.attr("groupIndex",o.groupIndex),n.attr("children",o.children)):angular.isDefined(o.groupIndex)?(n.attr("groupIndex",o.groupIndex),n.attr("indexInsideGroup",o.indexInsideGroup),e.options.stripRows&&o.indexInsideGroup%2==1&&n.addClass("odd-row")):e.options.stripRows&&o.rowIndex%2==1&&(n.addClass("odd-row"),e.options.fixedCols&&t.addClass("odd-row"));return e.options.listeners.onbeforerender&&e.options.listeners.onbeforerender(n,e),e.options.listeners.onrenderer(n,t,r,o.rowIndex,e),e.options.listeners.onafterrender&&e.options.listeners.onafterrender(n,e),o.rendered=!0,n};me.repaint=function(e){for(var o=e.managerRendererItems.getVisibleRows(),r=0;r<o.length;r++){var n=o[r];if(!n.rendered)if(angular.isDefined(e.options.cardView)){var t=e.options.cardView.numberOfColumns,i=$(document.createElement("div"));i.addClass("ui-row"),i.attr("rowindex",n.rowIndex),i.css("left","0px"),i.css("height",n.height),i.css("width","100%"),i.css("top",n.top+"px"),i.html('<table class="ui-table-card-view"><tr></tr></table>'),e.bodyContainer.append(i);for(var a=i.find("tr").get(0),l=(100/t).toString()+"%",s=0;t>s;s++){var d=n.rowIndex;n.rowIndex>0&&(d=n.rowIndex*t),d+=s;var c=e.options.data[d],u=$(a.insertCell());if(u.css("width",l),c){var p=uiDeniGridUtilSrv.applyTemplateValues(e.options.cardView.template,c);if(u.html(p),u.prop("record",c),u.click(function(o){e.bodyContainer.find("td").removeClass("selected"),$(o.currentTarget).addClass("selected"),e.options.listeners.onselectionchange&&e.options.listeners.onselectionchange($(o.currentTarget).prop("record"))}),1==e.options.cardView.checkbox){var f=$(document.createElement("input"));f.addClass("checkbox"),f.attr("type","checkbox"),-1!=e.checkedRecords.indexOf(c)&&f.attr("checked",!0),f.click(function(o){var r=$(o.target.parent).prop("record"),n=e.checkedRecords.indexOf(r);-1!=n&&e.checkedRecords.splice(n,1),o.target.checked&&e.checkedRecords.push(r),e.options.listeners.oncheckboxchange&&e.options.listeners.oncheckboxchange(r,e.checkedRecords,o.target)}),u.append(f)}}}n.rowElement=i}else{var c=e.options.data[n.rowIndex];n.rowElement=_renderRowEl(e,n,c)}}e.options.listeners.onafterrepaint&&e.options.listeners.onafterrepaint(e),e.managerRendererItems.removeAllNotVisibleElementsRows(e,o)},me.getRowIndex=function(e,o){for(var r=e.options.data,n=0;n<r.length;n++){var t=r[n];if(angular.equals(t,o))return n}return-1},me.resolveRowElement=function(e,o){var r=-1;if(angular.isObject(o)){if(angular.isElement(o))return o;r=me.getRowIndex(e,o)}else r=o;return e.bodyViewport.find(".ui-row[rowindex="+r+"]:not(.grouping)")},me.resolveRowIndex=function(e,o){return angular.isObject(o)?angular.isElement(o)?o.attr("rowindex"):me.getRowIndex(e,o):o}}),angular.module("ui-deni-grid").run(["$templateCache",function(e){e.put("ui-deni-grid-sections",'                <div class="ui-viewport">\n                    <div class="ui-container">\n                        <div class="ui-header-viewport-wrapper">\n                            <div class="ui-header-viewport">\n                                <div class="ui-header-container">\n                                </div>\n                            </div>\n                        </div>\n                        <div class="ui-body-viewport-wrapper">\n                            <div class="ui-body-viewport">\n                                <div class="ui-body-container">\n                                </div>\n                            </div>\n                        </div>\n                        <div class="ui-footer-viewport-wrapper">\n                            <div class="ui-footer-viewport">\n                                <div class="ui-footer-container">\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n'),e.put("ui-deni-grid",'<div class="ui-deni-grid-wrapper">\n    <div class="ui-deni-grid-viewport">\n        <div class="ui-deni-grid-container">\n            <div class="ui-fixed-cols-viewport-wrapper">\n'+e.get("ui-deni-grid-sections")+'            </div>\n            <div class="ui-variable-cols-viewport-wrapper">\n'+e.get("ui-deni-grid-sections")+"            </div>\n        </div>\n    </div>\n</div>")}]);